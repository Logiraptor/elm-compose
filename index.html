<html>
<body>
	<div id="main"></div>
	<script src="main.js"></script>
	<script src="config.js"></script>

	<script src="https://www.gstatic.com/firebasejs/3.4.1/firebase.js"></script>
	<script>
		// Initialize Firebase

		firebase.initializeApp(window.fbconfig);

		firebase.auth().onAuthStateChanged(function(user) {
			if (user) {
				var database = firebase.database();
				var rootRef = firebase.database().ref('users/'+user.uid);
				
				var app = Elm.Budget.fullscreen();

				app.ports.put.subscribe(function(model) {
					rootRef.set(model);
				});
				
				rootRef.on('value', function(snapshot) {
					app.ports.updates.send(snapshot.val());
				});
			} else {
				var provider = new firebase.auth.GoogleAuthProvider();
				firebase.auth().signInWithRedirect(provider);
			}
		});


		
	</script>
</body>
</html>